EFFECT
(UPPER_NAME State)
(LOWER_NAME a)
EQUALS
L_BRACE
VAL
(LOWER_NAME get)
COLON_SPACED
L_PAREN
R_PAREN
ARROW
(LOWER_NAME a)
VAL
(LOWER_NAME set)
COLON_SPACED
(LOWER_NAME a)
ARROW
L_PAREN
R_PAREN
R_BRACE
LET
(LOWER_NAME handle_state)
(LOWER_NAME init)
(LOWER_NAME f)
EQUALS
L_PAREN
HANDLE
(LOWER_NAME f)
L_PAREN
R_PAREN
PIPE
(LOWER_NAME x)
ARROW
L_PAREN
BACKSLASH
(LOWER_NAME s)
ARROW
L_PAREN
(LOWER_NAME s)
COMMA
(LOWER_NAME x)
R_PAREN
R_PAREN
PIPE
LESS_THAN
(LOWER_NAME get)
L_PAREN
R_PAREN
GREATER_THAN
ARROW
L_PAREN
BACKSLASH
(LOWER_NAME s)
ARROW
L_PAREN
RESUME
(LOWER_NAME s)
R_PAREN
(LOWER_NAME s)
R_PAREN
PIPE
LESS_THAN
(LOWER_NAME set)
(LOWER_NAME s)
GREATER_THAN
ARROW
L_PAREN
BACKSLASH
UNDERSCORE
ARROW
L_PAREN
RESUME
L_PAREN
R_PAREN
R_PAREN
(LOWER_NAME s)
R_PAREN
R_PAREN
(LOWER_NAME init)
LET
(LOWER_NAME while)
(LOWER_NAME cond)
(LOWER_NAME f)
EQUALS
IF
(LOWER_NAME cond)
L_PAREN
R_PAREN
THEN
(LOWER_NAME f)
L_PAREN
R_PAREN
(OPERATOR ";")
(LOWER_NAME while)
(LOWER_NAME cond)
(LOWER_NAME f)
ELSE
L_PAREN
R_PAREN
LET
(LOWER_NAME fib)
EQUALS
MATCH
PIPE
(INT 0)
PIPE
(INT 1)
ARROW
(INT 1)
PIPE
(LOWER_NAME n)
ARROW
LET
L_PAREN
L_PAREN
UNDERSCORE
COMMA
UNDERSCORE
COMMA
(LOWER_NAME res)
R_PAREN
COMMA
L_PAREN
R_PAREN
R_PAREN
EQUALS
(LOWER_NAME handle_state)
L_PAREN
(INT 1)
COMMA
(INT 1)
COMMA
(INT 1)
R_PAREN
L_PAREN
BACKSLASH
L_PAREN
R_PAREN
ARROW
(LOWER_NAME while)
L_PAREN
BACKSLASH
L_PAREN
R_PAREN
ARROW
LET
L_PAREN
(LOWER_NAME i)
COMMA
UNDERSCORE
COMMA
UNDERSCORE
R_PAREN
EQUALS
(LOWER_NAME get)
L_PAREN
R_PAREN
IN
(LOWER_NAME i)
LESS_THAN
(LOWER_NAME n)
R_PAREN
L_PAREN
BACKSLASH
L_PAREN
R_PAREN
ARROW
LET
L_PAREN
(LOWER_NAME i)
COMMA
(LOWER_NAME a)
COMMA
(LOWER_NAME b)
R_PAREN
EQUALS
(LOWER_NAME get)
L_PAREN
R_PAREN
IN
LET
(LOWER_NAME c)
EQUALS
(LOWER_NAME a)
(OPERATOR +)
(LOWER_NAME b)
IN
(LOWER_NAME set)
L_PAREN
(LOWER_NAME i)
(OPERATOR +)
(INT 1)
COMMA
(LOWER_NAME b)
COMMA
(LOWER_NAME c)
R_PAREN
R_PAREN
R_PAREN
IN
(LOWER_NAME res)
LET
L_PAREN
R_PAREN
EQUALS
(LOWER_NAME print_int)
L_PAREN
(LOWER_NAME fib)
(INT 6)
R_PAREN
EOF
